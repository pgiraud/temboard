!function(r){function t(t){for(var e,n,o=t[0],s=t[1],l=t[2],a=0,i=[];a<o.length;a++)n=o[a],d[n]&&i.push(d[n][0]),d[n]=0;for(e in s)Object.prototype.hasOwnProperty.call(s,e)&&(r[e]=s[e]);for(p&&p(t);i.length;)i.shift()();return u.push.apply(u,l||[]),c()}function c(){for(var t,e=0;e<u.length;e++){for(var n=u[e],o=!0,s=1;s<n.length;s++){var l=n[s];0!==d[l]&&(o=!1)}o&&(u.splice(e--,1),t=a(a.s=n[0]))}return t}var n={},d={4:0},u=[];function a(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return r[t].call(e.exports,e,e.exports,a),e.l=!0,e.exports}a.m=r,a.c=n,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/js/build";var e=window.webpackJsonp=window.webpackJsonp||[],o=e.push.bind(e);e.push=t,e=e.slice();for(var s=0;s<e.length;s++)t(e[s]);var p=o;u.push([12,6]),c()}({12:function(t,e,n){"use strict";n.r(e);var o=n(0),s=n.n(o);n(1);s()(window,$);var c='<div class="row mb-4"><div class="col-md-4 offset-md-4"><div class="progress"><div class="progress-bar progress-bar-striped" style="width: 100%;">Please wait ...</div></div></div></div>';function l(a,i,r){$("#"+a+"Label").html("Update instance properties"),$.ajax({url:"/json/settings/instance/"+i+"/"+r,type:"get",beforeSend:function(t){$("#"+a+"Info").html(c),$("#"+a+"Body").html(""),$("#"+a+"Footer").html('<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>')},async:!0,contentType:"application/json",dataType:"json",success:function(t){$("#"+a+"Info").html("");var e="";e+='<form id="formUpdateInstance">',e+='  <input type="hidden" id="inputAgentAddress" value="'+t.agent_address+'" />',e+='  <input type="hidden" id="inputAgentPort" value="'+t.agent_port+'" />',e+='  <div class="row">',e+='    <div class="form-group col-sm-6">',e+='      <label for="inputNewAgentAddress" class="control-label">Agent address</label>',e+='      <input type="text" class="form-control" id="inputNewAgentAddress" placeholder="ex: db.entreprise.lan" value="'+t.agent_address+'" />',e+="    </div>",e+='    <div class="form-group col-sm-6">',e+='      <label for="inputNewAgentPort" class="control-label">Agent port</label>',e+='      <input type="text" class="form-control" id="inputNewAgentPort" placeholder="ex: 2345" value="'+t.agent_port+'" />',e+="    </div>",e+="  </div>",e+='  <div class="row">',e+='    <div class="form-group col-sm-12">',e+='      <label for="inputAgentKey" class="control-label">Agent secret key</label>',e+='      <textarea class="form-control" rows="1" id="inputAgentKey">'+t.agent_key+"</textarea>",e+="    </div>",e+="  </div>",e+='  <div class="row">',e+='    <div class="form-group col-sm-6">',e+='      <label for="selectGroups" class="control-label">Groups</label><br />',e+='      <select id="selectGroups" multiple="multiple">';var n={},o="";for(var s in t.groups)o="",-1<t.in_groups.indexOf(s.name)&&(o="selected"),e+='      <option value="'+s.name+'" '+o+">"+s.name+"</option>",n[s.name]=s.description;e+="      </select>",e+="    </div>",e+='    <div class="form-group col-sm-6">',e+='      <label for="selectPlugins" class="control-label">Active plugins</label><br />',e+='      <select id="selectPlugins" multiple="multiple">';o="";for(var l in t.loaded_plugins)o="",-1<t.enabled_plugins.indexOf(l)&&(o="selected"),e+='      <option value="'+l+'" '+o+">"+l+"</option>";e+="      </select>",e+="    </div>",e+="  </div>",e+='  <div class="row">',e+='    <div class="col-sm-12">',e+='      <div class="form-check">',e+='        <input type="checkbox" class="form-check-input" id="inputNotify" '+(t.notify?"checked":"")+">",e+='        <label for="inputNotify" class="control-label">Notify users of any status alert</label>',e+="      </div>",e+="    </div>",e+="  </div>",e+="</form>";$("#"+a+"Body").html(e),$("#"+a+"Footer").html('<i class="fa fa-spinner fa-spin loader d-none"></i><button type="submit" id="submitFormUpdateInstance" class="btn btn-success ml-auto">Save</button> <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>'),$("#submitFormUpdateInstance").click(function(){($("#selectGroups").val()||confirm("No group selected.\nDo you want to proceed anyway?"))&&$("#formUpdateInstance").submit()}),$("#selectGroups").multiselect(),$("#selectPlugins").multiselect(),$(".multiselect-container li").not(".filter, .group").tooltip({placement:"right",container:"body",title:function(){var t=$(this).find("input").val();return n[t]}}),$("#formUpdateInstance").submit(function(t){t.preventDefault(),function(t,e,n,o,s,l,a){var i=["/json/settings/instance",e,n].join("/");d(t,i,o,s,l,a)}(a,i,r,$("#inputNewAgentAddress").val(),$("#inputNewAgentPort").val(),$("#inputAgentKey").val(),$("#inputNotify").prop("checked"))})},error:u.bind(null,a)})}function d(n,e,o,s,t,l){$.ajax({url:["/json/discover/instance",o,s].join("/"),type:"get",async:!0,contentType:"application/json",dataType:"json",beforeSend:a.bind(null,n),success:function(t){$.ajax({url:e,type:"post",data:JSON.stringify({new_agent_address:o,new_agent_port:s,agent_key:$("#inputAgentKey").val(),hostname:t.hostname,cpu:t.cpu,memory_size:t.memory_size,pg_data:t.pg_data,pg_port:t.pg_port,pg_version:t.pg_version,pg_version_summary:t.pg_version_summary,groups:$("#selectGroups").val(),plugins:$("#selectPlugins").val(),notify:l}),async:!0,contentType:"application/json",dataType:"json",beforeSend:a.bind(null,n),success:function(t){$("#"+n).modal("hide");var e=window.location.href;window.location.replace(e)},error:u.bind(null,n)})},error:u.bind(null,n)})}function u(t,e){!function(t){$("#"+t+" .loader").addClass("d-none")}(t),$("#"+t+"Info").html('<div class="alert alert-danger" role="alert">ERROR: '+function(t){return String(t).replace(/[&<>"'\/]/g,function(t){return p[t]})}(JSON.parse(e.responseText).error)+"</div>")}function a(t){$("#"+t+" .test-check-ok").addClass("d-none"),$("#"+t+"Info").html(""),$("#"+t+" .loader").removeClass("d-none")}function i(n,t,e){$("#"+n+"Label").html("Delete instance confirmation"),$.ajax({url:"/json/settings/instance/"+t+"/"+e,type:"get",beforeSend:function(t){$("#"+n+"Info").html(c),$("#"+n+"Body").html(""),$("#"+n+"Footer").html('<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>')},async:!0,contentType:"application/json",dataType:"json",success:function(e){$("#"+n+"Info").html("");$("#"+n+"Body").html(""),$("#"+n+"Footer").html('<button type="submit" id="buttonDeleteInstance" class="btn btn-danger">Yes, delete this instance</button> <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>'),$("#buttonDeleteInstance").click(function(t){t.preventDefault(),function(n,t,e){$.ajax({url:"/json/settings/delete/instance",type:"post",beforeSend:function(t){a(n),$("#"+n+"Body").html("")},async:!0,contentType:"application/json",dataType:"json",data:JSON.stringify({agent_address:t,agent_port:e}),success:function(t){$("#"+n).modal("hide");var e=window.location.href;window.location.replace(e)},error:function(t){u(t,n),$("#"+n+"Body").html("")}})}(n,e.agent_address,e.agent_port)})},error:function(t){u(n,t),$("#"+n+"Body").html(""),$("#"+n+"Footer").html('<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>')}})}function r(l){$("#"+l+"Label").html("Add a new instance"),$.ajax({url:"/json/settings/all/group/instance",type:"get",beforeSend:function(t){$("#"+l+"Info").html(c),$("#"+l+"Body").html(""),$("#"+l+"Footer").html('<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>')},async:!0,contentType:"application/json",dataType:"json",success:function(t){$("#"+l+"Info").html("");var e="";e+='<form id="formAddInstance">',e+='  <div class="row">',e+='    <div class="form-group col-sm-6">',e+='      <label for="inputNewAgentAddress" class="control-label">Agent address</label>',e+='      <input type="text" class="form-control" id="inputNewAgentAddress" placeholder="ex: db.entreprise.lan" />',e+="    </div>",e+='    <div class="form-group col-sm-6">',e+='      <label for="inputNewAgentPort" class="control-label">Agent port</label>',e+='      <input type="text" class="form-control" id="inputNewAgentPort" placeholder="ex: 2345" />',e+="    </div>",e+="  </div>",e+='  <div class="row">',e+='    <div class="form-group col-sm-12">',e+='      <label for="inputAgentKey" class="control-label">Agent secret key</label>',e+='      <textarea class="form-control" rows="3" id="inputAgentKey"></textarea>',e+="    </div>",e+="  </div>",e+='  <div class="row">',e+='    <div class="form-group col-sm-6">',e+='      <label for="selectGroups" class="control-label">Groups</label><br />',e+='      <select id="selectGroups" multiple="multiple">';var n={};for(var o in t.groups)e+='      <option value="'+o.name+'">'+o.name+"</option>",n[o.name]=o.description;e+="      </select>",e+="    </div>",e+='    <div class="form-group col-sm-6">',e+='      <label for="selectPlugins" class="control-label">Active plugins</label><br />',e+='      <select id="selectPlugins" multiple="multiple">';for(var s in t.loaded_plugins)e+='      <option value="'+s+'" selected>'+s+"</option>";e+="      </select>",e+="    </div>",e+="  </div>",e+='  <div class="row">',e+='    <div class="col-sm-12">',e+='      <div class="form-check">',e+='        <input type="checkbox" class="form-check-input" id="inputNotify" checked>',e+='        <label for="inputNotify" class="control-label">Notify users of any status alert</label>',e+="      </div>",e+="    </div>",e+="  </div>",e+="</form>";$("#"+l+"Body").html(e),$("#"+l+"Footer").html('<i class="fa fa-spinner fa-spin loader d-none"></i><button type="submit" id="submitFormAddInstance" class="btn btn-success ml-auto">Save</button><button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>'),$("#submitFormAddInstance").click(function(){$("#formAddInstance").submit()}),$("#selectGroups").multiselect(),$("#selectPlugins").multiselect(),$(".multiselect-container li").not(".filter, .group").tooltip({placement:"right",container:"body",title:function(){var t=$(this).find("input").val();return n[t]}}),$("#formAddInstance").submit(function(t){t.preventDefault(),function(t,e,n,o,s){d(t,"/json/settings/instance",e,n,o,s)}(l,$("#inputNewAgentAddress").val(),$("#inputNewAgentPort").val(),$("#inputAgentKey").val(),$("#inputNotify").prop("checked"))})},error:u.bind(null,l)})}var p={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};$(document).ready(function(){$("#tableInstances").DataTable({stateSave:!0}),$("#buttonLoadAddInstanceForm").click(function(){$("#InstanceModal").modal("show"),$("[data-toggle=popover]").popover("hide"),r("InstanceModal")}),$(document).on("click","[data-action=edit]",function(){$("#InstanceModal").modal("show"),$("[data-toggle=popover]").popover("hide"),l("InstanceModal",$(this).data("agent_address"),$(this).data("agent_port"))}),$(document).on("click","[data-action=delete]",function(){$("#InstanceModal").modal("show"),$("[data-toggle=popover]").popover("hide"),i("InstanceModal",$(this).data("agent_address"),$(this).data("agent_port"))})})}});